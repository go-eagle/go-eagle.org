"use strict";(self.webpackChunkgo_eagle_org_3=self.webpackChunkgo_eagle_org_3||[]).push([[1836],{722:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>g,frontMatter:()=>c,metadata:()=>s,toc:()=>p});var t=n(4848),o=n(8453);const c={id:"overview",title:"\u6982\u89c8",description:"Eagle \u4e00\u5957\u8f7b\u91cf\u7ea7 Go \u5fae\u670d\u52a1\u6846\u67b6\uff0c\u5305\u542b\u5927\u91cf\u5fae\u670d\u52a1\u76f8\u5173\u6846\u67b6\u53ca\u5de5\u5177",keywords:["Go","Eagle","interceptor","Toolkit","Framework","Microservices","HTTP"],slug:"/component/interceptor/overview"},i=void 0,s={id:"component/interceptor/overview",title:"\u6982\u89c8",description:"Eagle \u4e00\u5957\u8f7b\u91cf\u7ea7 Go \u5fae\u670d\u52a1\u6846\u67b6\uff0c\u5305\u542b\u5927\u91cf\u5fae\u670d\u52a1\u76f8\u5173\u6846\u67b6\u53ca\u5de5\u5177",source:"@site/docs/component/interceptor/orverview.md",sourceDirName:"component/interceptor",slug:"/component/interceptor/overview",permalink:"/docs/component/interceptor/overview",draft:!1,unlisted:!1,editUrl:"https://github.com/go-eagle/go-eagle.org/edit/main/docs/component/interceptor/orverview.md",tags:[],version:"current",frontMatter:{id:"overview",title:"\u6982\u89c8",description:"Eagle \u4e00\u5957\u8f7b\u91cf\u7ea7 Go \u5fae\u670d\u52a1\u6846\u67b6\uff0c\u5305\u542b\u5927\u91cf\u5fae\u670d\u52a1\u76f8\u5173\u6846\u67b6\u53ca\u5de5\u5177",keywords:["Go","Eagle","interceptor","Toolkit","Framework","Microservices","HTTP"],slug:"/component/interceptor/overview"},sidebar:"docs",previous:{title:"\u94fe\u8def\u8ffd\u8e2a",permalink:"/docs/component/middleware/tracing"},next:{title:"\u65e5\u5fd7\u62e6\u622a\u5668",permalink:"/docs/component/interceptor/logging"}},l={},p=[{value:"\u4ec0\u4e48\u662f\u62e6\u622a\u5668",id:"\u4ec0\u4e48\u662f\u62e6\u622a\u5668",level:2},{value:"\u4f7f\u7528\u62e6\u622a\u5668",id:"\u4f7f\u7528\u62e6\u622a\u5668",level:2},{value:"\u94fe\u5f0f\u62e6\u622a\u5668",id:"\u94fe\u5f0f\u62e6\u622a\u5668",level:2},{value:"\u793e\u533a\u62e6\u622a\u5668\u63d2\u4ef6",id:"\u793e\u533a\u62e6\u622a\u5668\u63d2\u4ef6",level:2},{value:"Rererence",id:"rererence",level:2}];function a(e){const r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"\u4ec0\u4e48\u662f\u62e6\u622a\u5668",children:"\u4ec0\u4e48\u662f\u62e6\u622a\u5668"}),"\n",(0,t.jsx)(r.p,{children:"gRPC\u7684\u62e6\u622a\u5668\uff08interceptor\uff09\u7c7b\u4f3c HTTP \u5e94\u7528\u7684\u4e2d\u95f4\u4ef6\uff08Middleware\uff09\uff0c\u8bf7\u6c42\u4e2d\u95f4\u4ef6\u5927\u5bb6\u90fd\u77e5\u9053\u662f\u5229\u7528\u88c5\u9970\u5668\u6a21\u5f0f\u5bf9\u6700\u7ec8\u5904\u7406\u8bf7\u6c42\u7684handler\u7a0b\u5e8f\u8fdb\u884c\u88c5\u9970\uff0c\u8fd9\u6837\u4e2d\u95f4\u4ef6\u5c31\u53ef\u4ee5\u5728\u5904\u7406\u8bf7\u6c42\u524d\u548c\u5b8c\u6210\u5904\u7406\u540e\u8fd9\u4e24\u4e2a\u65f6\u673a\u4e0a\uff0c\u62e6\u622a\u5230\u53d1\u9001\u7ed9 handler \u7684\u8bf7\u6c42\u4ee5\u53ca handler \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u54cd\u5e94 \u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u4e2d\u95f4\u4ef6\u7684\u6700\u5927\u7684\u7528\u5904\u662f\u53ef\u4ee5\u628a\u4e00\u4e9b handler \u7684\u524d\u7f6e\u548c\u540e\u7f6e\u64cd\u4f5c\u4ece handler \u7a0b\u5e8f\u4e2d\u89e3\u8026\u51fa\u6765\uff0c\u6bd4\u5982\u6700\u5e38\u89c1\u7684\u8bb0\u5f55\u54cd\u5e94\u65f6\u957f\u3001\u8bb0\u5f55\u8bf7\u6c42\u548c\u54cd\u5e94\u6570\u636e\u65e5\u5fd7\u7b49\u64cd\u4f5c\u5f80\u5f80\u662f\u901a\u8fc7\u4e2d\u95f4\u4ef6\u7a0b\u5e8f\u5b9e\u73b0\u7684\u3002"}),"\n",(0,t.jsxs)(r.p,{children:["\u4e0e HTTP \u5e94\u7528\u7684\u4e2d\u95f4\u4ef6\u540c\u7406\uff0c\u53ef\u4ee5\u5bf9gRPC\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u8fdb\u884c\u62e6\u622a\u5904\u7406\uff0c\u800c\u4e14\u65e2\u53ef\u4ee5\u5728 ",(0,t.jsx)(r.strong,{children:"\u5ba2\u6237\u7aef\u8fdb\u884c\u62e6\u622a"})," \uff0c\u4e5f\u53ef\u4ee5\u5bf9",(0,t.jsx)(r.strong,{children:"\u670d\u52a1\u5668\u7aef\u8fdb\u884c\u62e6\u622a"}),"\u3002\u5229\u7528\u62e6\u622a\u5668\uff0c\u53ef\u4ee5\u5bf9gRPC\u8fdb\u884c\u5f88\u597d\u7684\u6269\u5c55\uff0c\u628a\u4e00\u4e9b\u4e1a\u52a1\u903b\u8f91\u5916\u7684\u5197\u4f59\u64cd\u4f5c\u4ece handler \u4e2d\u62bd\u79bb\uff0c\u63d0\u5347\u9879\u76ee\u7684\u5f00\u53d1\u6548\u7387\u548c\u6269\u5c55\u6027\u3002"]}),"\n",(0,t.jsx)(r.h2,{id:"\u4f7f\u7528\u62e6\u622a\u5668",children:"\u4f7f\u7528\u62e6\u622a\u5668"}),"\n",(0,t.jsx)(r.p,{children:"gRPC\u7684\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u90fd\u662f\u5206\u522b\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u5355\u5411\u8c03\u7528 (Unary) \u7684\u62e6\u622a\u5668\u548c\u6d41\u5f0f\u8c03\u7528 (Stream) \u7684\u62e6\u622a\u5668\u3002"}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"\u8fd9\u4e24\u79cd\u8c03\u7528\u65b9\u5f0f\u7684\u533a\u522b\u53ef\u4ee5\u7406\u89e3\u4e3aHTTP\u548cWebSocket\u7684\u533a\u522b"}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["\u5bf9\u4e8e\u5ba2\u6237\u7aef\u7684\u5355\u5411\u8c03\u7528\u7684\u62e6\u622a\uff0c\u53ea\u9700\u5b9a\u4e49\u4e00\u4e2a ",(0,t.jsx)(r.code,{children:"UnaryClientInterceptor"})," \u65b9\u6cd5:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"type UnaryClientInterceptor func(ctx context.Context, method string, req, reply interface{}, cc *ClientConn, invoker UnaryInvoker, opts ...CallOption) error\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u800c\u5ba2\u6237\u7aef\u6d41\u5f0f\u8c03\u7528\u7684\u62e6\u622a\uff0c\u5219\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a StreamClientInterceptor \u65b9\u6cd5:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"type StreamClientInterceptor func(ctx context.Context, desc *StreamDesc, cc *ClientConn, method string, streamer Streamer, opts ...CallOption) (ClientStream, error)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["\u540c\u7406\uff0c\u5bf9\u4e8egRPC\u7684\u670d\u52a1\u7aef\u4e5f\u6709\u8fd9\u4e24\u79cd\u8c03\u7528\u7684\u62e6\u622a\u5668\u65b9\u6cd5\uff0c\u5206\u522b\u662f ",(0,t.jsx)(r.code,{children:"UnaryServerInterceptor"})," \u548c ",(0,t.jsx)(r.code,{children:"StreamServerInterceptor"}),"\uff1a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:"type UnaryServerInterceptor func(ctx context.Context, req interface{}, info *UnaryServerInfo, handler UnaryHandler) (resp interface{}, err error)\n\ntype StreamServerInterceptor func(srv interface{}, ss ServerStream, info *StreamServerInfo, handler StreamHandler) error\n"})}),"\n",(0,t.jsx)(r.h2,{id:"\u94fe\u5f0f\u62e6\u622a\u5668",children:"\u94fe\u5f0f\u62e6\u622a\u5668"}),"\n",(0,t.jsx)(r.p,{children:"\u4e0e HTTP \u4e2d\u95f4\u4ef6\u4e0d\u540c\u7684\u662f\uff0cHTTP \u4e2d\u95f4\u4ef6\u53ef\u4ee5\u7ed9\u6bcf\u4e2a handler \u7a0b\u5e8f\u5e94\u7528\u591a\u4e2a\u4e2d\u95f4\u4ef6\uff0cgRPC\u5b98\u65b9\u4e5f\u63d0\u4f9b\u4e86\u94fe\u5f0f\u64cd\u4f5c\uff0c\u793e\u533a\u7248\u4e5f\u6709\u63d0\u4f9b."}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"eagle \u91cc\u4f7f\u7528\u7684\u662f\u5b98\u65b9\u7248\u672c"}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"\u5b98\u65b9\u7248\uff1a\u65b0\u7248\u672c\u7684 gRPC \u5df2\u7ecf\u63d0\u4f9b\u4e86\u5185\u7f6e\u7684\u94fe\u5f0f Interceptor \u5b9e\u73b0"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// \u5ba2\u6237\u7aef\nimport "google.golang.org/grpc"\n\n// dialoptions.go\nWithChainUnaryInterceptor(interceptors ...UnaryClientInterceptor) DialOption\nWithStreamInterceptor(f StreamClientInterceptor) DialOption\n\n// \u670d\u52a1\u7aef\nimport "google.golang.org/grpc"\n\n// server.go\nChainUnaryInterceptor(interceptors ...UnaryServerInterceptor) ServerOption\nStreamInterceptor(i StreamServerInterceptor) ServerOption\n'})}),"\n",(0,t.jsxs)(r.p,{children:["\u793e\u533a\u7248\uff1a\u7531 grpc-ecosystem \u63d0\u4f9b\u7684 ",(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/chain.go",children:"\u94fe\u5f0f\u529f\u80fd"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-go",children:'// \u5ba2\u6237\u7aef\nimport (\n  ...\n  "google.golang.org/grpc"\n  "github.com/grpc-ecosystem/go-grpc-middleware"\n  ...\n)\n\n// chain.go\nChainUnaryClient(interceptors ...grpc.UnaryClientInterceptor) grpc.UnaryClientInterceptor\nChainStreamClient(interceptors ...grpc.StreamClientInterceptor) grpc.StreamClientInterceptor\n\n// \u670d\u52a1\u7aef\nimport (\n  "google.golang.org/grpc"\n  "github.com/grpc-ecosystem/go-grpc-middleware"\n)\n\n// chain.go\nChainUnaryServer(interceptors ...grpc.UnaryServerInterceptor) grpc.UnaryServerInterceptor\nChainStreamServer(interceptors ...grpc.StreamServerInterceptor) grpc.StreamServerInterceptor\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u793e\u533a\u62e6\u622a\u5668\u63d2\u4ef6",children:"\u793e\u533a\u62e6\u622a\u5668\u63d2\u4ef6"}),"\n",(0,t.jsx)(r.p,{children:"\u5229\u7528\u62e6\u622a\u5668\uff0c\u53ef\u4ee5\u5bf9gRPC\u8fdb\u884c\u6269\u5c55\uff0c\u5229\u7528\u793e\u533a\u7684\u529b\u91cf\u5c06gRPC\u53d1\u5c55\u58ee\u5927\uff0c\u4e5f\u53ef\u4ee5\u8ba9\u5f00\u53d1\u8005\u66f4\u7075\u6d3b\u5730\u5904\u7406gRPC\u6d41\u7a0b\u4e2d\u7684\u4e1a\u52a1\u903b\u8f91\u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u4e0b\u9762\u5217\u51fa\u4e86\u5229\u7528\u62e6\u622a\u5668\u5b9e\u73b0\u7684\u4e00\u4e9b\u529f\u80fd\u6846\u67b6\uff1a"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware",children:"Go gRPC Middleware"}),":\u63d0\u4f9b\u4e86\u62e6\u622a\u5668\u7684interceptor\u94fe\u5f0f\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u62e6\u622a\u5668\u7ec4\u5408\u6210\u4e00\u4e2a\u62e6\u622a\u5668\u94fe\uff0c\u5f53\u7136\u5b83\u8fd8\u63d0\u4f9b\u4e86\u5176\u5b83\u7684\u529f\u80fd\uff0c\u6240\u4ee5\u4ee5gRPC\u4e2d\u95f4\u4ef6\u547d\u540d\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/kazegusuri/grpc-multi-interceptor",children:"grpc-multi-interceptor"}),": \u662f\u53e6\u4e00\u4e2ainterceptor\u94fe\u5f0f\u529f\u80fd\u7684\u5e93\uff0c\u4e5f\u53ef\u4ee5\u5c06\u5355\u5411\u7684\u6216\u8005\u6d41\u5f0f\u7684\u62e6\u622a\u5668\u7ec4\u5408\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/auth",children:"grpc_auth"}),": \u8eab\u4efd\u9a8c\u8bc1\u62e6\u622a\u5668"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/tags",children:"grpc_ctxtags"}),": \u4e3a\u4e0a\u4e0b\u6587\u589e\u52a0Tag map\u5bf9\u8c61"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/logging/zap",children:"grpc_zap"}),": \u652f\u6301zap\u65e5\u5fd7\u6846\u67b6"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/logging/logrus",children:"grpc_logrus"}),": \u652f\u6301logrus\u65e5\u5fd7\u6846\u67b6"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-prometheus",children:"grpc_prometheus"}),": \u652f\u6301 prometheus"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/grpc-opentracing/tree/master/go/otgrpc",children:"otgrpc"}),": \u652f\u6301opentracing/zipkin"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/tracing/opentracing",children:"grpc_opentracing"}),":\u652f\u6301opentracing/zipkin"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/retry",children:"grpc_retry"}),": \u4e3a\u5ba2\u6237\u7aef\u589e\u52a0\u91cd\u8bd5\u7684\u529f\u80fd"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware/blob/master/validator",children:"grpc_validator"}),": \u4e3a\u670d\u52a1\u5668\u7aef\u589e\u52a0\u6821\u9a8c\u7684\u529f\u80fd"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"rererence",children:"Rererence"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"https://github.com/grpc-ecosystem/go-grpc-middleware",children:"https://github.com/grpc-ecosystem/go-grpc-middleware"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"https://github.com/kevinyan815/gocookbook/issues/60",children:"https://github.com/kevinyan815/gocookbook/issues/60"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"https://pandaychen.github.io/2019/11/20/GRPC-INTERCEPTOR-APPLY/",children:"https://pandaychen.github.io/2019/11/20/GRPC-INTERCEPTOR-APPLY/"})}),"\n"]})]})}function g(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>s});var t=n(6540);const o={},c=t.createContext(o);function i(e){const r=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(c.Provider,{value:r},e.children)}}}]);