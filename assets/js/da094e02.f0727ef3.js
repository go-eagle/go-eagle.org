"use strict";(self.webpackChunkgo_eagle_org_3=self.webpackChunkgo_eagle_org_3||[]).push([[1160],{7818:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"guide/http-guide","title":"Swagger \u6587\u6863","description":"\u57fa\u4e8eOpenAPI 3\u751f\u6210\u7684swagger\u63a5\u53e3\u6587\u6863","source":"@site/docs/guide/swagger-doc.md","sourceDirName":"guide","slug":"/guide/swagger-doc","permalink":"/docs/guide/swagger-doc","draft":false,"unlisted":false,"editUrl":"https://github.com/go-eagle/go-eagle.org/edit/main/docs/guide/swagger-doc.md","tags":[],"version":"current","frontMatter":{"id":"http-guide","title":"Swagger \u6587\u6863","description":"\u57fa\u4e8eOpenAPI 3\u751f\u6210\u7684swagger\u63a5\u53e3\u6587\u6863","keywords":["Go","Eagle","http","Toolkit","Framework","Microservices","HTTP"],"slug":"/guide/swagger-doc"},"sidebar":"docs","previous":{"title":"\u5f00\u53d1\u6d41\u7a0b - gRPC","permalink":"/docs/guide/grpc-guide"},"next":{"title":"gRPC \u57fa\u51c6\u548c\u8d1f\u8f7d\u6d4b\u8bd5","permalink":"/docs/guide/grpc-benchmark"}}');var i=t(4848),r=t(8453);const s={id:"http-guide",title:"Swagger \u6587\u6863",description:"\u57fa\u4e8eOpenAPI 3\u751f\u6210\u7684swagger\u63a5\u53e3\u6587\u6863",keywords:["Go","Eagle","http","Toolkit","Framework","Microservices","HTTP"],slug:"/guide/swagger-doc"},a=void 0,c={},p=[{value:"\u6587\u6863\u5b9a\u4e49",id:"\u6587\u6863\u5b9a\u4e49",level:2},{value:"\u57fa\u672c\u4fe1\u606f\u7684\u5b9a\u4e49",id:"\u57fa\u672c\u4fe1\u606f\u7684\u5b9a\u4e49",level:3},{value:"\u4e3aservice\u548cmessage\u589e\u52a0\u6ce8\u91ca",id:"\u4e3aservice\u548cmessage\u589e\u52a0\u6ce8\u91ca",level:3},{value:"\u4f7f\u7528\u811a\u672c\u751f\u6210\u6587\u6863",id:"\u4f7f\u7528\u811a\u672c\u751f\u6210\u6587\u6863",level:3},{value:"Reference",id:"reference",level:2}];function g(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"Swagger\u6587\u6863"}),"\n",(0,i.jsxs)(e.p,{children:["Swagger\u6587\u6863\u4e3b\u8981\u57fa\u4e8eopenapi v3\u7248\u672c\u751f\u6210\uff0c\u901a\u8fc7\u5728 proto \u91cc\u5b9a\u4e49 option\uff0c \u7136\u540e\u901a\u8fc7google\u5f00\u6e90\u7684 ",(0,i.jsx)(e.code,{children:"gnostic"})," \u6765\u751f\u6210\u3002"]}),"\n",(0,i.jsx)(e.h2,{id:"\u6587\u6863\u5b9a\u4e49",children:"\u6587\u6863\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.h3,{id:"\u57fa\u672c\u4fe1\u606f\u7684\u5b9a\u4e49",children:"\u57fa\u672c\u4fe1\u606f\u7684\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u5b9a\u4e49\u7684\u57fa\u672c\u4fe1\u606f\u5305\u542b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6807\u9898"}),"\n",(0,i.jsx)(e.li,{children:"\u7248\u672c"}),"\n",(0,i.jsx)(e.li,{children:"\u63cf\u8ff0"}),"\n",(0,i.jsx)(e.li,{children:"\u8054\u7cfb\u4eba\u7684\u59d3\u540d\uff0cEmail"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u7684\u73af\u5883\u540d\u79f0\u53ca\u5bf9\u5e94\u7684\u63a5\u53e3\u5730\u5740"}),"\n",(0,i.jsx)(e.li,{children:"\u8ba4\u8bc1\u7684\u65b9\u5f0f, \u6bd4\u5982JWT"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e3e\u4f8b\u5982\u4e0b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage api.micro.user.v1;\n\nimport "google/api/annotations.proto";\nimport "gogo/protobuf/gogo.proto";\nimport "openapiv3/annotations.proto";\n\noption go_package = "github.com/go-microservice/ins-api/api/micro/user/v1;v1";\n\n// \u6587\u6863\u57fa\u672c\u4fe1\u606f\u5b9a\u4e49\noption (openapi.v3.document) = {\n  info: {\n    title: "ins-api";\n    version: "v1.0.0";\n    description: "Description from annotation";\n    contact: {\n      name: "Contact Name";\n      url: "https://github.com/go-microservice/ins-api";\n      email: "";\n    }\n    license: {\n      name: "MIT License";\n      url: "https://github.com/go-microservice/ins-api/blob/main/LICENSE";\n    }\n  }\n  servers: [\n    {\n      url: "http://localhost:8081";\n      description: "\u6d4b\u8bd5\u73af\u5883";\n    },\n    {\n      url: "http://api.go-microservice.io";\n      description: "\u7ebf\u4e0a\u73af\u5883";\n    }\n  ]\n  components: {\n    security_schemes: {\n      additional_properties: [\n        {\n          name: "bearerAuth";\n          value: {\n            security_scheme: {\n              type: "http";\n              scheme: "bearer";\n              bearer_format: "JWT";\n            }\n          }\n        }\n      ]\n    }\n  }\n  security: [\n    {\n      additional_properties: [\n        {\n          name: "bearerAuth";\n          value: {\n            value: []\n          }\n        }\n      ]\n    }\n  ]\n};\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6548\u679c\u5982\u4e0b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"https://user-images.githubusercontent.com/3043638/224539211-433d8939-64e9-4045-bc33-67d171d429ee.png",alt:"swagger-doc-demo"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4e3aservice\u548cmessage\u589e\u52a0\u6ce8\u91ca",children:"\u4e3aservice\u548cmessage\u589e\u52a0\u6ce8\u91ca"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679c\u60f3\u8ba9service\u3001method\u53ca\u5b57\u6bb5\u5728\u6587\u6863\u91cc\u90fd\u6709\u6bd4\u8f83\u6e05\u6670\u7684\u8bf4\u660e\uff0c\u53ef\u4ee5\u5728\u5bf9\u5e94proto\u7684\u5730\u65b9\u52a0\u4e0a\u8be6\u7ec6\u7684\u6ce8\u91ca\uff0c\u793a\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage api.micro.moment.v1;\n\nimport "google/api/annotations.proto";\nimport "api/micro/user/v1/user.proto";\nimport "gogo/protobuf/gogo.proto";\nimport "openapiv3/annotations.proto";\n\noption go_package = "github.com/go-microservice/ins-api/api/micro/moment/v1;v1";\noption java_multiple_files = true;\noption java_package = "api.micro.moment.v1";\n\n// \u8bc4\u8bba\u63a5\u53e3\nservice CommentService {\n\t// \u521b\u5efa\u8bc4\u8bba\n\trpc CreateComment (CreateCommentRequest) returns (CreateCommentReply) {\n\t\toption (google.api.http) = {\n\t\t\tpost: "/v1/comments"\n\t\t\tbody: "*"\n\t\t};\n\t};\n}\n\n// \u8bc4\u8bba\u7ed3\u6784\nmessage Comment {\n\t// \u8bc4\u8bbaid\n\tstring id = 1 [(gogoproto.jsontag) = "id"];\n\t// \u5e16\u5b50id\n\tint64 post_id = 2 [(gogoproto.jsontag) = "post_id"];\n\t// \u7528\u6237\u4fe1\u606f\n\tapi.micro.user.v1.User user = 3 [(gogoproto.jsontag) = "user"];\n\t// \u8bc4\u8bba\u5185\u5bb9\n\tstring content = 4 [(gogoproto.jsontag) = "content"];\n\t// \u6839\u8bc4\u8bbaid\n\tint64 root_id = 5 [(gogoproto.jsontag) = "root_id"];\n\t// \u7236\u8bc4\u8bbaid\n\tint64 parent_id = 6 [(gogoproto.jsontag) = "parent_id"];\n\t// \u70b9\u8d5e\u6570\n\tint32 like_count = 7 [(gogoproto.jsontag) = "like_count"];\n\t// \u56de\u590d\u6570\n\tint32 reply_count = 8 [(gogoproto.jsontag) = "reply_count"];\n\t// \u5206\u6570\n\tint64 score = 9 [(gogoproto.jsontag) = "score"];\n\t// \u5220\u9664\u6807\u8bb0\n\tint32 del_flag = 10 [(gogoproto.jsontag) = "del_flag"];\n\t// \u521b\u5efa\u65f6\u95f4\n\tint64 created_at = 11 [(gogoproto.jsontag) = "created_at"];\n\t// \u66f4\u65b0\u65f6\u95f4\n\tint64 updated_at = 12 [(gogoproto.jsontag) = "updated_at"];\n\t// \u8bbe\u5907\u7c7b\u578b iOS/Android\n\tstring device_type = 13 [(gogoproto.jsontag) = "device_type"];\n\t// \u7528\u6237id\n\tstring ip = 14 [(gogoproto.jsontag) = "ip"];\n}\n\nmessage CreateCommentRequest {\n    // \u5e16\u5b50id\n\tint64 post_id = 1;\n\t// \u53d1\u5e03\u8bc4\u8bba\u7684uid\n\tint64 user_id = 2;\n\t// \u8bc4\u8bba\u7684\u5177\u4f53\u5185\u5bb9\n\tstring content = 3;\n\t// \u8bc4\u8bba\u7684\u6839id\n\tint64 root_id = 4;\n\t// \u8bc4\u8bba\u7684\u4e0a\u4e00\u7ea7id\n\tint64 parent_id = 5;\n\t// \u8bbe\u5907\u7c7b\u578b\uff0c\u6bd4\u5982iOS, Android\n\tstring device_type = 6;\n\t// \u8bc4\u8bba\u4eba\u7684ip\u5730\u5740\n\tstring ip = 7;\n}\nmessage CreateCommentReply {\n\tComment comment = 1;\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u811a\u672c\u751f\u6210\u6587\u6863",children:"\u4f7f\u7528\u811a\u672c\u751f\u6210\u6587\u6863"}),"\n",(0,i.jsxs)(e.p,{children:["\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u751f\u6210\u4e00\u4e2a\u6587\u4ef6\uff1a",(0,i.jsx)(e.code,{children:"openapi.yaml"}),"\uff0c\u4f4d\u4e8e\u6839\u76ee\u5f55\u7684docs\u76ee\u5f55\u4e0b\uff0c \u7136\u540e\u901a\u8fc7\u5bf9\u5e94\u7684js\u548ccss\u8fdb\u884c\u6e32\u67d3\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"make grpc\nmake openapi\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6700\u540e\u5f00\u542fweb server\u540e\u5373\u53ef\u8fdb\u884c\u8bbf\u95ee\uff0c\u8bbf\u95ee\u5730\u5740\uff1a",(0,i.jsx)(e.code,{children:"http://localhost:8081/docs"})]}),"\n",(0,i.jsx)(e.h2,{id:"reference",children:"Reference"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/google/gnostic/blob/main/openapiv3/OpenAPIv3.proto",children:"https://github.com/google/gnostic/blob/main/openapiv3/OpenAPIv3.proto"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/google/gnostic/blob/main/cmd/protoc-gen-openapi/examples/tests/openapiv3annotations/message.proto",children:"https://github.com/google/gnostic/blob/main/cmd/protoc-gen-openapi/examples/tests/openapiv3annotations/message.proto"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://swagger.io/docs/specification/basic-structure/",children:"https://swagger.io/docs/specification/basic-structure/"})}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(g,{...n})}):g(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var o=t(6540);const i={},r=o.createContext(i);function s(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);